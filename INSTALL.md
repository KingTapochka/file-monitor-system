# üöÄ –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±–µ–∑ MSI)

## ‚ö° –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±

### 1Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

```powershell
# –û—Ç–∫—Ä–æ–π—Ç–µ PowerShell –æ—Ç –∏–º–µ–Ω–∏ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê

# –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
cd C:\monitoring_polzovateley

# –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏)
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force
```

### 2Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å –º–µ–Ω—é –≤—ã–±–æ—Ä–∞
.\Scripts\Install-All.ps1

# –í—ã–±–µ—Ä–∏—Ç–µ:
#   1 - –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ–ª—å–∫–æ –°–ï–†–í–ï–†–ê
#   2 - –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ç–æ–ª—å–∫–æ –ö–õ–ò–ï–ù–¢–ê  
#   3 - –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–ë–û–ò–• –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (.NET 8 / .NET Framework 4.8)
- ‚úÖ –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
- ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Windows Service (—Å–µ—Ä–≤–µ—Ä)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Shell Extension (–∫–ª–∏–µ–Ω—Ç)
- ‚úÖ –ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã / –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ Explorer

### 3Ô∏è‚É£ –£–¥–∞–ª–µ–Ω–∏–µ

```powershell
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–∏–Ω—Å—Ç–∞–ª–ª—è—Ç–æ—Ä
.\Scripts\Uninstall-All.ps1

# –í—ã–±–µ—Ä–∏—Ç–µ —á—Ç–æ —É–¥–∞–ª–∏—Ç—å (1-3)
```

---

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä–∞

```powershell
.\Scripts\Install-All.ps1 -Component Server
```

## üíª –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–∞

```powershell
.\Scripts\Install-All.ps1 -Component Client
```

---

## ‚ùì –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞: .NET SDK –Ω–µ –Ω–∞–π–¥–µ–Ω

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ .NET 8 SDK
winget install Microsoft.DotNet.SDK.8

# –ò–ª–∏ —Å–∫–∞—á–∞–π—Ç–µ: https://dotnet.microsoft.com/download/dotnet/8.0
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ —É–¥–∞–µ—Ç—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫—Ä–∏–ø—Ç

```powershell
# –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process -Force

# –í–∞—Ä–∏–∞–Ω—Ç 2: –†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

```powershell
# –ó–∞–∫—Ä–æ–π—Ç–µ PowerShell –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –∑–∞–Ω–æ–≤–æ:
# –ü–ö–ú –Ω–∞ PowerShell ‚Üí "–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞"
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### –°–µ—Ä–≤–µ—Ä:

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª—É–∂–±—ã
Get-Service FileMonitorService

# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
Invoke-RestMethod -Uri "http://localhost:5000/api/files/health"

# –û—Ç–∫—Ä—ã—Ç—å Swagger
Start-Process "https://localhost:5001/swagger"
```

### –ö–ª–∏–µ–Ω—Ç:

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
dir "C:\Program Files\File Monitor System\Client"

# –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ Explorer
# 2. –ü–ö–ú –Ω–∞ –ª—é–±–æ–º —Ñ–∞–π–ª–µ
# 3. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—É–Ω–∫—Ç "–ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª?"
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ

–î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–Ω–æ–≤–æ:

```powershell
.\Scripts\Install-All.ps1
```

–°—Ç–∞—Ä—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–µ–Ω—ã –ø–µ—Ä–µ–¥ —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π –Ω–æ–≤—ã—Ö.

---

## üí° –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —ç—Ç–æ–≥–æ —Å–ø–æ—Å–æ–±–∞

- ‚úÖ **–ù–µ –Ω—É–∂–µ–Ω WiX Toolset** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É
- ‚úÖ **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é** - –≤—ã–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å –≤—Ä—É—á–Ω—É—é
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** - –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–¥–∞–ª—è–µ—Ç –≤—Å—ë

---

## üìù –ü—É—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–°–µ—Ä–≤–µ—Ä:**
- –ü—É—Ç—å: `C:\Program Files\File Monitor System\Service\`
- –°–ª—É–∂–±–∞: `FileMonitorService`
- –õ–æ–≥–∏: `C:\Program Files\File Monitor System\Service\logs\`

**–ö–ª–∏–µ–Ω—Ç:**
- –ü—É—Ç—å: `C:\Program Files\File Monitor System\Client\`
- DLL: `FileMonitorClient.dll`

---

## üéØ –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

–ï—Å–ª–∏ –≤—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ —Ö–æ—Ç–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
cd FileMonitorService
dotnet run

# –í –¥—Ä—É–≥–æ–º –æ–∫–Ω–µ - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç–∞
.\Scripts\Install-All.ps1 -Component Client
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–∏ PowerShell –æ—Ç –∏–º–µ–Ω–∏ **–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω **.NET 8 SDK**: `dotnet --version`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ **–ø–æ–ª–∏—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∞**: `Get-ExecutionPolicy`
4. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **–ª–æ–≥–∏** –≤: `C:\Program Files\File Monitor System\Service\logs\`

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ–±–∞–≤—å—Ç–µ `-Verbose`:
```powershell
.\Scripts\Install-All.ps1 -Verbose
```
