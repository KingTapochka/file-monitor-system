# üöÄ –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢ - File Monitor System

## ‚úÖ –í–°–ï –ì–û–¢–û–í–û –ö –£–°–¢–ê–ù–û–í–ö–ï!

MSI —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å–æ–∑–¥–∞–Ω: `Installer\FileMonitorSetup.msi` (2.25 MB)

---

## üì¶ –®–ê–ì 1: –£–°–¢–ê–ù–û–í–ö–ê

### –í–∞—Ä–∏–∞–Ω—Ç –ê: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ò —Å–µ—Ä–≤–µ—Ä–∞, –ò –∫–ª–∏–µ–Ω—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

**–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ MSI:**
```powershell
msiexec /i "C:\monitoring_polzovateley\Installer\FileMonitorSetup.msi"
```

–ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ **–û–¢–ú–ï–¢–¨–¢–ï –ì–ê–õ–û–ß–ö–ê–ú–ò** –æ–±–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
- ‚òë –°–µ—Ä–≤–µ—Ä–Ω–∞—è —Å–ª—É–∂–±–∞ (FileMonitorService)
- ‚òë –ö–ª–∏–µ–Ω—Ç—Å–∫–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (Shell Extension)

### –í–∞—Ä–∏–∞–Ω—Ç –ë: –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä (–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ Windows Server)

```powershell
msiexec /i "C:\monitoring_polzovateley\Installer\FileMonitorSetup.msi" ADDLOCAL=ServerFeature /qb
```

### –í–∞—Ä–∏–∞–Ω—Ç –í: –¢–æ–ª—å–∫–æ –∫–ª–∏–µ–Ω—Ç (–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞ —Ä–∞–±–æ—á–∏—Ö —Å—Ç–∞–Ω—Ü–∏—è—Ö)

```powershell
msiexec /i "C:\monitoring_polzovateley\Installer\FileMonitorSetup.msi" ADDLOCAL=ClientFeature /qb
```

---

## üîß –®–ê–ì 2: –ù–ê–°–¢–†–û–ô–ö–ê (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

### –ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ PowerShell –û–¢ –ò–ú–ï–ù–ò –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê:

```powershell
cd "C:\monitoring_polzovateley"

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
.\Scripts\Test-System.ps1
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
1. ‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã
2. ‚úì **–ó–ê–ü–£–°–¢–ò–¢ —Å–ª—É–∂–±—É** (–µ—Å–ª–∏ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞)
3. ‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç API
4. ‚úì –ü–æ–∫–∞–∂–µ—Ç –ª–æ–≥–∏
5. ‚úì –ü—Ä–æ–≤–µ—Ä–∏—Ç Shell Extension
6. ‚úì –î–∞—Å—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å Shell Extension:

```powershell
.\Scripts\Register-ShellExtension.ps1
```

‚ö†Ô∏è **Explorer –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è** - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!

---

## üß™ –®–ê–ì 3: –ü–†–û–í–ï–†–ö–ê –†–ê–ë–û–¢–´

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞:

```powershell
# –ü—Ä–æ–≤–µ—Ä–∫–∞ API
Invoke-RestMethod -Uri "http://localhost:5000/api/files/health"

# –û—Ç–∫—Ä—ã—Ç—å Swagger UI –≤ –±—Ä–∞—É–∑–µ—Ä–µ
Start-Process "http://localhost:5000/swagger"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞ (Shell Extension):

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Windows Explorer**
2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
3. **–©–µ–ª–∫–Ω–∏—Ç–µ –ü–†–ê–í–û–ô –∫–Ω–æ–ø–∫–æ–π –º—ã—à–∏** –Ω–∞ —Ñ–∞–π–ª–µ
4. –ù–∞–π–¥–∏—Ç–µ –ø—É–Ω–∫—Ç **"–ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª?"**
5. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π

---

## üî® –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Explorer –ª–æ–º–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏"

**–ü—Ä–∏—á–∏–Ω–∞:** Shell Extension –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω  
**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –û—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
.\Scripts\Unregister-ShellExtension.ps1
.\Scripts\Register-ShellExtension.ps1
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "–°–ª—É–∂–±–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞"

**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –û—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
Start-Service -Name FileMonitorService

# –ü—Ä–æ–≤–µ—Ä–∫–∞
Get-Service -Name FileMonitorService
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "–ö–ª–∏–µ–Ω—Ç –Ω–µ –≤–∏–¥–∏—Ç —Å–µ—Ä–≤–µ—Ä"

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

**–§–∞–π–ª:** `C:\Program Files\File Monitor System\Client\FileMonitorClient.dll.config`

```xml
<appSettings>
    <!-- –ó–∞–º–µ–Ω–∏—Ç–µ localhost –Ω–∞ IP-–∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ -->
    <add key="ServerAddress" value="http://192.168.1.100:5000" />
</appSettings>
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "–ù–µ –≤–∏–∂—É –ø—É–Ω–∫—Ç –º–µ–Ω—é"

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Shell Extension –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: `.\Scripts\Test-System.ps1`
2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∫–ª–∏–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –Ω—É–∂–Ω—É—é –ø–∞–ø–∫—É

---

## üìä –ê–†–•–ò–¢–ï–ö–¢–£–†–ê (–∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)

```
–°–ï–†–í–ï–† (Windows Server)
  ‚Üì
FileMonitorService (—Å–ª—É–∂–±–∞ Windows)
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç –æ—Ç–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã (Get-SmbOpenFile)
  - –ö–µ—à–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  - –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç Web API (http://localhost:5000)
  ‚Üì
     [–°–ï–¢–¨]
  ‚Üì
–ö–õ–ò–ï–ù–¢ (–†–∞–±–æ—á–∞—è —Å—Ç–∞–Ω—Ü–∏—è)
  ‚Üì
FileMonitorClient (Shell Extension)
  - –î–æ–±–∞–≤–ª—è–µ—Ç –ø—É–Ω–∫—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
  - –ü–ö–ú –Ω–∞ —Ñ–∞–π–ª ‚Üí "–ö—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∞–π–ª?"
  - –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç API —Å–µ—Ä–≤–µ—Ä–∞
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç WPF –æ–∫–Ω–æ —Å–æ —Å–ø–∏—Å–∫–æ–º
```

---

## üìù –ë–´–°–¢–†–ê–Ø –°–ü–†–ê–í–ö–ê

| –ß—Ç–æ –Ω—É–∂–Ω–æ | –ö–æ–º–∞–Ω–¥–∞ |
|-----------|---------|
| **–ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** | `.\Scripts\Test-System.ps1` |
| **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Shell Extension** | `.\Scripts\Register-ShellExtension.ps1` |
| **–ó–∞–ø—É—Å–∫ —Å–ª—É–∂–±—ã** | `Start-Service FileMonitorService` |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ API** | `Invoke-RestMethod http://localhost:5000/api/files/health` |
| **Swagger UI** | `Start-Process http://localhost:5000/swagger` |
| **–õ–æ–≥–∏** | `C:\Program Files\File Monitor System\Service\logs` |

---

## ‚ùì –ü–†–û GUI –£–°–¢–ê–ù–û–í–©–ò–ö–ê

**–í–æ–ø—Ä–æ—Å:** "–ü–æ—á–µ–º—É –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è GUI?"

**–û—Ç–≤–µ—Ç:** GUI **–ï–°–¢–¨**! –≠—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Windows Installer:

‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ MSI –≤—ã —É–≤–∏–¥–∏—Ç–µ:
1. –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
2. **–í—ã–±–æ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤** (–≥–∞–ª–æ—á–∫–∏ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞/–∫–ª–∏–µ–Ω—Ç–∞)
3. –í—ã–±–æ—Ä –ø–∞–ø–∫–∏
4. –ü—Ä–æ–≥—Ä–µ—Å—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏
5. –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ

–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ **–∫–∞—Å—Ç–æ–º–Ω—ã–π GUI** —Å –ø–æ–ª—è–º–∏ –≤–≤–æ–¥–∞ (–∞–¥—Ä–µ—Å, –ø–æ—Ä—Ç):
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ (—Å–º. –í–∞—Ä–∏–∞–Ω—Ç –ë –≤—ã—à–µ)
- –ò–ª–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

---

## üéØ –ß–¢–û –î–ê–õ–¨–®–ï?

### –î–ª—è production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–ª—å–∫–æ ServerFeature
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Å–ª—É–∂–±–∞ –∑–∞–ø—É—â–µ–Ω–∞
   - –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç 5000 –≤ –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–µ

2. **–ù–∞ –∫–ª–∏–µ–Ω—Ç–∞—Ö:**
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ç–æ–ª—å–∫–æ ClientFeature
   - –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `FileMonitorClient.dll.config`
   - –£–∫–∞–∂–∏—Ç–µ IP-–∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞

3. **–î–ª—è –º–∞—Å—Å–æ–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GPO (—Å–º. `MSI_INSTALL_GUIDE.md`)
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SCCM/Intune

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

- `TROUBLESHOOTING.md` - –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- `MSI_INSTALL_GUIDE.md` - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏, GPO
- `README.md` - –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- `GIT_SETUP.md` - –†–∞–±–æ—Ç–∞ —Å git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º

---

## üÜò –ù–£–ñ–ù–ê –ü–û–ú–û–©–¨?

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:** `.\Scripts\Test-System.ps1`
2. –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ –≤—ã–≤–æ–¥ - –æ–Ω –ø–æ–∫–∞–∂–µ—Ç —á—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏–∑ `TROUBLESHOOTING.md`

**–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** –ü—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —à–∞–≥–∏ 1-2-3 –≤—ã—à–µ.
